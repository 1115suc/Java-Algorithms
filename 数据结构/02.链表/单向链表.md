# ğŸ”— å•å‘é“¾è¡¨

## ğŸ“š é“¾è¡¨æ¦‚è¿°

åœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œé“¾è¡¨æ˜¯æ•°æ®å…ƒç´ çš„çº¿æ€§é›†åˆï¼Œå…¶æ¯ä¸ªå…ƒç´ éƒ½æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå…ƒç´ å­˜å‚¨ä¸Šå¹¶ä¸è¿ç»­

> In computer science, a **linked list** is a linear collection of data elements whose order is not given by their physical placement in memory. Instead, each element points to the next.

### ğŸ“Š é“¾è¡¨åˆ†ç±»

* **å•å‘é“¾è¡¨**ï¼Œæ¯ä¸ªå…ƒç´ åªçŸ¥é“å…¶ä¸‹ä¸€ä¸ªå…ƒç´ æ˜¯è°
  ![image-20221110083407176](imgs\image-20221110083407176.png)

* **åŒå‘é“¾è¡¨**ï¼Œæ¯ä¸ªå…ƒç´ çŸ¥é“å…¶ä¸Šä¸€ä¸ªå…ƒç´ å’Œä¸‹ä¸€ä¸ªå…ƒç´ 
  ![image-20221110083427372](imgs\image-20221110083427372.png)

* **å¾ªç¯é“¾è¡¨**ï¼Œé€šå¸¸çš„é“¾è¡¨å°¾èŠ‚ç‚¹ `tail` æŒ‡å‘çš„éƒ½æ˜¯ `null`ï¼Œè€Œå¾ªç¯é“¾è¡¨çš„ `tail` æŒ‡å‘çš„æ˜¯å¤´èŠ‚ç‚¹ `head`
  ![image-20221110083538273](imgs\image-20221110083538273.png)

### ğŸ›¡ï¸ å“¨å…µèŠ‚ç‚¹

é“¾è¡¨å†…è¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„èŠ‚ç‚¹ç§°ä¸ºå“¨å…µï¼ˆSentinelï¼‰èŠ‚ç‚¹ï¼Œä¹Ÿå«åšå“‘å…ƒï¼ˆDummyï¼‰èŠ‚ç‚¹ï¼Œå®ƒä¸å­˜å‚¨æ•°æ®ï¼Œé€šå¸¸ç”¨ä½œå¤´å°¾ï¼Œç”¨æ¥ç®€åŒ–è¾¹ç•Œåˆ¤æ–­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º
![image-20221110084611550](imgs\image-20221110084611550.png)

### âš¡ æ€§èƒ½åˆ†æ

**éšæœºè®¿é—®æ€§èƒ½**:
æ ¹æ® index æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n)$

**æ’å…¥æˆ–åˆ é™¤æ€§èƒ½**:
* èµ·å§‹ä½ç½®ï¼š$O(1)$
* ç»“æŸä½ç½®ï¼šå¦‚æœå·²çŸ¥ tail å°¾èŠ‚ç‚¹æ˜¯ $O(1)$ï¼Œä¸çŸ¥é“ tail å°¾èŠ‚ç‚¹æ˜¯ $O(n)$
* ä¸­é—´ä½ç½®ï¼šæ ¹æ® index æŸ¥æ‰¾æ—¶é—´ + $O(1)$

---

## ğŸ¯ å•å‘é“¾è¡¨å®ç°

### ğŸ—ï¸ å•å‘é“¾è¡¨ç±» `SinglyLinkedList`

æ ¹æ®å•å‘é“¾è¡¨çš„å®šä¹‰ï¼Œé¦–å…ˆå®šä¹‰ä¸€ä¸ªå­˜å‚¨ `value` å’Œ `next` æŒ‡é’ˆçš„ç±» `Node`ï¼Œå’Œä¸€ä¸ªæè¿°å¤´éƒ¨èŠ‚ç‚¹çš„å¼•ç”¨

```java
public class SinglyLinkedList {
    
    private Node head; // å¤´éƒ¨èŠ‚ç‚¹
    
    private static class Node { // èŠ‚ç‚¹ç±»
        int value;
        Node next;

        public Node(int value, Node next) {
            this.value = value;
            this.next = next;
        }
    }
}
```


#### ğŸ’¡ è®¾è®¡è¦ç‚¹ï¼š
* `Node` å®šä¹‰ä¸ºå†…éƒ¨ç±»ï¼Œæ˜¯ä¸ºäº†å¯¹å¤–**éšè—**å®ç°ç»†èŠ‚ï¼Œæ²¡å¿…è¦è®©ç±»çš„ä½¿ç”¨è€…å…³å¿ƒ `Node` ç»“æ„
* å®šä¹‰ä¸º `static` å†…éƒ¨ç±»ï¼Œæ˜¯å› ä¸º `Node` **ä¸éœ€è¦**ä¸ `SinglyLinkedList` å®ä¾‹ç›¸å…³ï¼Œå¤šä¸ª `SinglyLinkedList` å®ä¾‹èƒ½å…±ç”¨ `Node` ç±»å®šä¹‰

### â• å¤´éƒ¨æ·»åŠ 

```java
public class SinglyLinkedList {
    public void addFirst(int value) {
		this.head = new Node(value, this.head);
    }
}
```


#### ğŸ“ æ‰§è¡Œé€»è¾‘ï¼š
* å¦‚æœ `this.head == null`ï¼Œæ–°å¢èŠ‚ç‚¹æŒ‡å‘ `null`ï¼Œå¹¶ä½œä¸ºæ–°çš„ `this.head`
* å¦‚æœ `this.head != null`ï¼Œæ–°å¢èŠ‚ç‚¹æŒ‡å‘åŸæ¥çš„ `this.head`ï¼Œå¹¶ä½œä¸ºæ–°çš„ `this.head`
    * æ³¨æ„èµ‹å€¼æ“ä½œæ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦

### ğŸ” éå†æ–¹å¼

#### while éå†

```java
public class SinglyLinkedList {
    public void loop() {
        Node curr = this.head;
        while (curr != null) {
            curr = curr.next;
        }
    }
}
```


#### for éå†

```java
public class SinglyLinkedList {
    public void loop() {
        for (Node curr = this.head; curr != null; curr = curr.next) {
            // åšä¸€äº›äº‹
        }
    }
}
```


#### ğŸ“ ç‰¹ç‚¹è¯´æ˜ï¼š
* ä»¥ä¸Šä¸¤ç§éå†éƒ½å¯ä»¥æŠŠ**è¦åšçš„äº‹**ä»¥ `Consumer` å‡½æ•°çš„æ–¹å¼ä¼ é€’è¿›æ¥
    * `Consumer` çš„è§„åˆ™æ˜¯**ä¸€ä¸ªå‚æ•°**ï¼Œ**æ— è¿”å›å€¼**ï¼Œå› æ­¤åƒ `System.out::println` æ–¹æ³•ç­‰éƒ½æ˜¯ `Consumer`
    * è°ƒç”¨ `Consumer` æ—¶ï¼Œå°†å½“å‰èŠ‚ç‚¹ `curr.value` ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒ

#### è¿­ä»£å™¨éå†

```java
public class SinglyLinkedList implements Iterable<Integer> {
    // ...
    private class NodeIterator implements Iterator<Integer> {
        Node curr = head;
        
        public boolean hasNext() {
            return curr != null;
        }

        public Integer next() {
            int value = curr.value;
            curr = curr.next;
            return value;
        }
    }
    
    public Iterator<Integer> iterator() {
        return new NodeIterator();
    }
}
```


#### ğŸ“ å…³é”®è¦ç‚¹ï¼š
* `hasNext` ç”¨æ¥åˆ¤æ–­æ˜¯å¦è¿˜æœ‰å¿…è¦è°ƒç”¨ `next`
* `next` åšä¸¤ä»¶äº‹
    * è¿”å›å½“å‰èŠ‚ç‚¹çš„ `value`
    * æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
* `NodeIterator` è¦å®šä¹‰ä¸º**é `static` å†…éƒ¨ç±»**ï¼Œæ˜¯å› ä¸ºå®ƒä¸ `SinglyLinkedList` å®ä¾‹ç›¸å…³ï¼Œæ˜¯å¯¹æŸä¸ª `SinglyLinkedList` å®ä¾‹çš„è¿­ä»£

#### é€’å½’éå†

```java
public class SinglyLinkedList implements Iterable<Integer> {
    public void loop() {
        recursion(this.head);
    }

    private void recursion(Node curr) {
        if (curr == null) {
            return;
        }
        // å‰é¢åšäº›äº‹
        recursion(curr.next);
        // åé¢åšäº›äº‹
    }
}
```


### â• å°¾éƒ¨æ·»åŠ 

```java
public class SinglyLinkedList {
    // ...
    private Node findLast() {
        if (this.head == null) {
            return null;
        }
        Node curr;
        for (curr = this.head; curr.next != null; ) {
            curr = curr.next;
        }
        return curr;
    }
    
    public void addLast(int value) {
        Node last = findLast();
        if (last == null) {
            addFirst(value);
            return;
        }
        last.next = new Node(value, null);
    }
}
```


#### ğŸ“ å®ç°è¦ç‚¹ï¼š
* æ³¨æ„ï¼Œæ‰¾æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œç»ˆæ­¢æ¡ä»¶æ˜¯ `curr.next == null`
* åˆ†æˆä¸¤ä¸ªæ–¹æ³•æ˜¯ä¸ºäº†ä»£ç æ¸…æ™°ï¼Œè€Œä¸” `findLast()` ä¹‹åè¿˜èƒ½å¤ç”¨

#### å°¾éƒ¨æ·»åŠ å¤šä¸ª

```java
public class SinglyLinkedList {
    // ...
	public void addLast(int first, int[] rest) {
        
        Node sublist = new Node(first, null);
        Node curr = sublist;
        for (int value : rest) {
            curr.next = new Node(value, null);
            curr = curr.next;
        }
        
        Node last = findLast();
        if (last == null) {
            this.head = sublist;
            return;
        }
        last.next = sublist;
    }
}
```


#### ğŸ“ å®ç°æ€è·¯ï¼š
* å…ˆä¸²æˆä¸€ä¸² `sublist`
* å†ä½œä¸ºä¸€ä¸ªæ•´ä½“æ·»åŠ 

### ğŸ” æ ¹æ®ç´¢å¼•è·å–

```java
public class SinglyLinkedList {
    // ...
	private Node findNode(int index) {
        int i = 0;
        for (Node curr = this.head; curr != null; curr = curr.next, i++) {
            if (index == i) {
                return curr;
            }
        }
        return null;
    }
    
    private IllegalArgumentException illegalIndex(int index) {
        return new IllegalArgumentException(String.format("index [%d] ä¸åˆæ³•%n", index));
    }
    
    public int get(int index) {
        Node node = findNode(index);
        if (node != null) {
            return node.value;
        }
        throw illegalIndex(index);
    }
}
```


#### ğŸ“ è®¾è®¡æ€æƒ³ï¼š
* åŒæ ·ï¼Œåˆ†æ–¹æ³•å¯ä»¥å®ç°å¤ç”¨

### â• æ’å…¥æ“ä½œ

```java
public class SinglyLinkedList {
    // ...
	public void insert(int index, int value) {
        if (index == 0) {
            addFirst(value);
            return;
        }
        Node prev = findNode(index - 1); // æ‰¾åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹
        if (prev == null) { // æ‰¾ä¸åˆ°
            throw illegalIndex(index);
        }
        prev.next = new Node(value, prev.next);
    }
}
```


#### ğŸ“ å…³é”®ç‚¹ï¼š
* æ’å…¥åŒ…æ‹¬ä¸‹é¢çš„åˆ é™¤ï¼Œéƒ½å¿…é¡»æ‰¾åˆ°ä¸Šä¸€ä¸ªèŠ‚ç‚¹

### â– åˆ é™¤æ“ä½œ

```java
public class SinglyLinkedList {
    // ...
	public void remove(int index) {
        if (index == 0) {
            if (this.head != null) {
                this.head = this.head.next;
                return;
            } else {
                throw illegalIndex(index);
            }
        }
        Node prev = findNode(index - 1);
        Node curr;
        if (prev != null && (curr = prev.next) != null) {
            prev.next = curr.next;
        } else {
            throw illegalIndex(index);
        }
    }
}
```


#### ğŸ“ å¤„ç†é€»è¾‘ï¼š
* ç¬¬ä¸€ä¸ª `if` å—å¯¹åº”ç€ `removeFirst` æƒ…å†µ
* æœ€åä¸€ä¸ª `if` å—å¯¹åº”ç€è‡³å°‘å¾—ä¸¤ä¸ªèŠ‚ç‚¹çš„æƒ…å†µ
    * ä¸ä»…ä»…åˆ¤æ–­ä¸Šä¸€ä¸ªèŠ‚ç‚¹éç©ºï¼Œè¿˜è¦ä¿è¯å½“å‰èŠ‚ç‚¹éç©º